from firedrake import *
import math

ncells = 40
L = 1
mesh = PeriodicIntervalMesh(ncells, L)

V = FunctionSpace(mesh, "DG", 1)         
W = VectorFunctionSpace(mesh, "CG", 1) 
x, = SpatialCoordinate(mesh)
q = Function(V).interpolate(exp(-(x-0.5)**2/(0.2**2/2)))
Q = Function(V).interpolate(exp(-(x)**2/(0.2**2/2)))
u = Function(W)
U = Function(W)

T = 3
dt = T/500
dtc = Constant(dt)
q_in = Constant(1.0)
m = Constant(1.0)
dq_trial = TrialFunction(V)
